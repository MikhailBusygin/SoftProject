## A lightweight Spring Boot service that efficiently finds the N-th smallest number in Excel files. Provides REST API with Swagger documentation and implements optimized algorithms for quick number selection without full array sorting.

## Key Features:
- Reads numeric data from XLSX files
- Finds N-th smallest element using efficient algorithms
- REST API with automatic Swagger documentation

# Number Service

Сервис для поиска N-ного минимального числа в XLSX файлах.

## О проекте

Сервис предоставляет REST API для поиска N-ного минимального числа в Excel файлах (XLSX формата). 
Реализован на Spring Boot с использованием эффективного алгоритма на основе max-heap.

## Быстрый старт

### Предварительные требования
- Java 17 или выше
- Maven 3.6 или выше
- ОС Windows
- Доступ к интернету

### Установка и запуск

1. Клонируйте репозиторий
```bash
git clone <url-репозитория>
```

2. Перейдите в директорию
```bash
cd nth-minimal-service
```

3. Соберите проект
```bash
mvn clean package
```

4. Запустите проект
```bash
java -jar target/nth-minimal-service-1.0.0.jar
```

5. Откройте в браузере
```text
http://localhost:8080/swagger-ui.html
```

### Использование Через Swagger UI

1. Откройте http://localhost:8080/swagger-ui.html

2. Найдите метод POST /api/numbers/find-nth-min
	- Нажмите "Try it out"

3. Введите параметры:
	- filePath: путь к XLSX файлу (например: C:/data/numbers.xlsx)
	- n: порядковый номер минимального числа (например: 3)

### Пример тестового XLSX файла

Создайте файл numbers.xlsx с одним столбцом чисел:

| Числа в файле |
|---------------|
| 15            |
| 7             |
| 23            |
| 4             |
| 19            |
| 1             |

Запрос с n=3 вернет 7 (третье минимальное число после сортировки: 1, 4, 7)

## Особенности реализации

1. Эффективный алгоритм: Используется max-heap для поиска N-ного минимального элемента без полной сортировки массива
2. Обработка ошибок: Валидация входных параметров и обработка исключений
3. Swagger документация: Автоматическая генерация API документации
4. Чтение Excel: Поддержка XLSX формата через Apache POI

Алгоритм имеет временную сложность O(M log N) где M - количество чисел, N - искомый порядковый номер, что эффективнее полной сортировки O(M log M) при небольших N.

## Технологии

- Java 14
- Spring Boot 3.2.0
- Apache POI - работа с Excel файлами
- SpringDoc OpenAPI - Swagger документация
- Maven - сборка проекта

## API Endpoints

| Метод | Endpoint                  | Описание                        |
|-------|---------------------------|---------------------------------|
| POST  | /api/numbers/find-nth-min | Поиск N-ного минимального числа |

## Решение проблем

### Проблема: "File not found"
Решение: Убедитесь, что:
- Указан полный путь к файлу
- Файл существует и доступен для чтения
- Путь указан в правильном формате для вашей ОС

### Проблема: "Invalid file format"
Решение: Убедитесь, что файл:
- Имеет расширение .xlsx
- Содержит числовые данные в первом столбце
- Не защищен паролем

### Проблема: Порт 8080 занят
Решение: Запустите приложение на другом порту:
```bash
java -jar target/nth-minimal-service-1.0.0.jar --server.port=8081
```

## Идеи по улучшению

### Добавить умный поиск числовых данных в таблице
- Автоматически ищет столбец с наибольшим количеством чисел
- Пропускает пустые ячейки и заголовки
- Работает с числами в любом столбце (A, B, C, ...)
- Понимает числа как в числовом, так и в строковом формате
- Начинает с любой строки - не важно с 1й или 2й

Пример

|   A   |   B   |   C   |
|-------|-------|-------|
|   1   | текст |   23  |
|   2   | текст |   4   |

Теперь сервис сам найдет где твои числа!

## Альтернативный метод согласно условиям задачи

QuickSelect - это усовершенствованная версия QuickSort, которая находит K-й наименьший элемент за O(n) в среднем случае.
